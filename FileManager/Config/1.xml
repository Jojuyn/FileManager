<flowchart type="graph" direction="TD">
    <!-- 启动与主界面加载流程 -->
    <node id="A" label="用户启动程序"/>
    <node id="B" label="主界面加载" type="decision"/>
    <node id="C" label="显示顶部路径输入框+中部文件列表区+底部操作按钮"/>
    <node id="D" label="提示错误信息并退出"/>
    
    <connection from="A" to="B"/>
    <connection from="B" to="C" condition="加载成功"/>
    <connection from="B" to="D" condition="加载失败"/>

    <!-- 核心功能：文件浏览与列表 -->
    <node id="E" label="用户操作" type="decision"/>
    <node id="F" label="调用FileManager.getDirContents"/>
    <node id="G" label="更新文件列表区显示"/>
    <node id="H" label="弹窗提示错误"/>
    <node id="I" label="获取父目录路径"/>
    
    <connection from="C" to="E"/>
    <connection from="E" to="F" condition="输入路径并确认"/>
    <connection from="F" to="G" condition="成功"/>
    <connection from="F" to="H" condition="失败"/>
    <connection from="E" to="F" condition="点击文件夹"/>
    <connection from="E" to="I" condition="点击返回上级按钮"/>
    <connection from="I" to="F"/>

    <!-- 核心功能：基本文件操作 -->
    <node id="J" label="弹出确认对话框"/>
    <node id="K" label="调用FileManager.deleteFile"/>
    <node id="L" label="输入目标路径"/>
    <node id="M" label="调用FileManager.copyFile"/>
    <node id="N" label="显示复制进度"/>
    <node id="O" label="输入文件夹名称"/>
    <node id="P" label="调用FileManager.createDir"/>
    <node id="Q" label="调用FileManager.readTextFile"/>
    <node id="R" label="弹窗显示文件内容"/>
    
    <connection from="E" to="J" condition="选中文件+点击删除"/>
    <connection from="J" to="K" condition="确认"/>
    <connection from="K" to="G" condition="成功"/>
    <connection from="K" to="H" condition="失败"/>
    <connection from="J" to="G" condition="取消"/>
    
    <connection from="E" to="L" condition="选中文件+点击复制"/>
    <connection from="L" to="M"/>
    <connection from="M" to="N" condition="大文件"/>
    <connection from="N" to="G" condition="完成"/>
    <connection from="M" to="G" condition="成功"/>
    <connection from="M" to="H" condition="失败"/>
    
    <connection from="E" to="O" condition="点击创建文件夹"/>
    <connection from="O" to="P"/>
    <connection from="P" to="G" condition="成功"/>
    <connection from="P" to="H" condition="失败"/>
    
    <connection from="E" to="Q" condition="选中文本文件+点击查看"/>
    <connection from="Q" to="R" condition="成功"/>
    <connection from="Q" to="H" condition="失败"/>

    <!-- 辅助功能：配置管理 -->
    <node id="S" label="ConfigManager.loadConfig加载配置"/>
    <node id="T" label="初始化默认路径/最近访问路径"/>
    <node id="U" label="ConfigManager.addRecentPath记录"/>
    <node id="V" label="ConfigManager.saveConfig保存配置"/>
    
    <connection from="C" to="S"/>
    <connection from="S" to="T"/>
    <connection from="E" to="U" condition="切换路径"/>
    <connection from="E" to="V" condition="关闭程序"/>

    <!-- 辅助功能：文件搜索 -->
    <node id="W" label="调用SearchEngine.search"/>
    <node id="X" label="字符串匹配筛选结果"/>
    <node id="Y" label="按条件排序结果"/>
    <node id="Z" label="显示搜索结果列表"/>
    
    <connection from="E" to="W" condition="输入关键词+点击搜索"/>
    <connection from="W" to="X" condition="递归遍历目录"/>
    <connection from="X" to="Y"/>
    <connection from="Y" to="Z"/>

    <!-- 辅助功能：快捷键 -->
    <node id="AA" label="触发对应操作，如Ctrl+C=复制"/>
    
    <connection from="E" to="AA" condition="按下快捷键"/>
    <connection from="AA" to="L" label="如L/M"/>
    <connection from="AA" to="M" label="如L/M"/>

    <!-- 辅助功能：视觉优化 -->
    <node id="AB" label="加载样式表设置界面外观"/>
    <node id="AC" label="更新样式表"/>
    
    <connection from="C" to="AB"/>
    <connection from="E" to="AC" condition="切换主题"/>
</flowchart>